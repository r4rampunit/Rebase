<body>
    <div class="logo-container"></div>
    <h1>MI Tool Visualization</h1>
    <div class="dashboard-container">
        <form id="dashboard-form">
            <div class="dropdown-container">
                <select name="folder" id="folder">
                    <option value="">Select Variable</option>
                    {% for folder in folders %}
                        <option value="{{ folder }}" {% if folder == selected_folder %}selected{% endif %}>{{ folder }}</option>
                    {% endfor %}
                </select>
                <button type="submit">Submit</button>
            </div>
        </form>
        {% if selected_folder %}
            <h2>Selected Folder: {{ selected_folder }}</h2>
        {% endif %}
        {% if dataframes %}
            <h2>Data from Excel Files</h2>
            {% for df_name, df in dataframes.items %}
                <h3>{{ df_name }}</h3>
                <p>Columns: {{ df.columns|join:", " }}</p>
                <p>Rows: {{ df.shape.0 }}</p>
                <table border="1">
                    <thead>
                        <tr>
                            {% for col in df.columns %}
                                <th>{{ col }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for _, row in df.iterrows %}
                            {% if forloop.first %}
                                <tr>
                                    {% for cell in row %}
                                        <td>{{ cell }}</td>
                                    {% endfor %}
                                </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            {% endfor %}
        {% else %}
            <p>No data to display</p>
        {% endif %}
    </div>
</body>



import os
from django.shortcuts import render
import pandas as pd

FOLDER_PATH = r"C:\Users\45363901\MI Tool Visualization\punitproject\Folder"

def get_folders():
    folders = [f.name for f in os.scandir(FOLDER_PATH) if f.is_dir()]
    print("Folders:", folders)  # Debug print
    return folders

def read_excel_files(folder_name):
    folder_path = os.path.join(FOLDER_PATH, folder_name)
    excel_files = [f for f in os.listdir(folder_path) if f.endswith('.xlsx')]
    dataframes = {}
    for excel_file in excel_files:
        file_path = os.path.join(folder_path, excel_file)
        df = pd.read_excel(file_path)
        dataframes[excel_file] = df
    return dataframes

def dashboard(request):
    folders = get_folders()
    selected_folder = request.GET.get('folder')
    dataframes = {}

    if selected_folder:
        dataframes = read_excel_files(selected_folder)

    # Debug response
    print(f"Folders: {folders}")
    print(f"Number of folders: {len(folders)}")
    print(f"Folder type: {type(folders)}")
    print(f"Selected folder: {selected_folder}")
    print(f"Number of dataframes: {len(dataframes)}")

    context = {
        'folders': folders,
        'dataframes': dataframes,
        'selected_folder': selected_folder,
    }

    return render(request, 'dashboard.html', context)