import os
import pandas as pd
from django.shortcuts import render
from django.conf import settings

# Specify the location where your folders are stored
FOLDER_PATH = '/path/to/your/folders'  # Change this to your folder path

def get_folders():
    # List all folders in the specified location
    return [f.name for f in os.scandir(FOLDER_PATH) if f.is_dir()]

def read_excel_files(folder_name):
    folder_path = os.path.join(FOLDER_PATH, folder_name)
    excel_files = [f for f in os.listdir(folder_path) if f.endswith('.xlsx')]
    dataframes = []

    for i, excel_file in enumerate(excel_files):
        file_path = os.path.join(folder_path, excel_file)
        df = pd.read_excel(file_path)
        dataframes.append(df)

    return dataframes

def folder_view(request):
    folders = get_folders()
    dataframes = []

    if request.method == 'POST':
        selected_folder = request.POST.get('folder')
        if selected_folder:
            dataframes = read_excel_files(selected_folder)

    context = {
        'folders': folders,
        'dataframes': dataframes,
    }

    return render(request, 'myapp/folder_view.html', context)





















<!DOCTYPE html>
<html>
<head>
    <title>Select Folder</title>
</head>
<body>
    <h1>Select a Folder</h1>
    <form method="post">
        {% csrf_token %}
        <select name="folder">
            {% for folder in folders %}
                <option value="{{ folder }}">{{ folder }}</option>
            {% endfor %}
        </select>
        <button type="submit">Submit</button>
    </form>

    {% if dataframes %}
        <h2>Data from Excel Files</h2>
        {% for df in dataframes %}
            <h3>DataFrame {{ forloop.counter }}</h3>
            <table border="1">
                <thead>
                    <tr>
                        {% for col in df.columns %}
                            <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in df.values %}
                        <tr>
                            {% for cell in row %}
                                <td>{{ cell }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endfor %}
    {% endif %}
</body>
</html>



































pip install django pandas openpyxl

