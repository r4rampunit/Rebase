import os
import pandas as pd
from django.shortcuts import render
from django.conf import settings

FOLDER_PATH = r'C:\Users\45363901\MI_Tool_Visualization\punitproject\Folder_Structure'

def get_folders():
    return [f.name for f in os.scandir(FOLDER_PATH) if f.is_dir()]

def read_excel_files(folder_name):
    folder_path = os.path.join(FOLDER_PATH, folder_name)
    excel_files = [f for f in os.listdir(folder_path) if f.endswith('.xlsx')]
    dataframes = []
    for excel_file in excel_files:
        file_path = os.path.join(folder_path, excel_file)
        df = pd.read_excel(file_path)
        dataframes.append(df)
    return dataframes

def folder_view(request):
    folders = get_folders()
    dataframes = []
    selected_folder = None
    if request.method == 'POST':
        selected_folder = request.POST.get('folder')
        if selected_folder:
            dataframes = read_excel_files(selected_folder)
    context = {
        'folders': folders,
        'dataframes': dataframes,
        'selected_folder': selected_folder,
    }
    return render(request, 'main_file.html', context)














<!DOCTYPE html>
<html>
<head>
    <title>Select Folder</title>
</head>
<body>
    <h1>Select a Folder</h1>
    <form method="post">
        {% csrf_token %}
        <select name="folder">
            <option value="">Select a folder</option>
            {% for folder in folders %}
                <option value="{{ folder }}" {% if folder == selected_folder %}selected{% endif %}>{{ folder }}</option>
            {% endfor %}
        </select>
        <button type="submit">Submit</button>
    </form>

    {% if selected_folder %}
        <h2>Selected Folder: {{ selected_folder }}</h2>
    {% endif %}

    {% if dataframes %}
        <h2>Data from Excel Files</h2>
        {% for df in dataframes %}
            <h3>DataFrame {{ forloop.counter }}</h3>
            <table border="1">
                <thead>
                    <tr>
                        {% for col in df.columns %}
                            <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for _, row in df.iterrows %}
                        <tr>
                            {% for cell in row %}
                                <td>{{ cell }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endfor %}
    {% endif %}
</body>
</html>












import os
import pandas as pd
from django.shortcuts import render

FOLDER_PATH = r'C:\Users\45363901\MI_Tool_Visualization\punitproject\Folder_Structure'

def get_folders():
    return [f.name for f in os.scandir(FOLDER_PATH) if f.is_dir()]

def read_excel_files(folder_name):
    folder_path = os.path.join(FOLDER_PATH, folder_name)
    excel_files = [f for f in os.listdir(folder_path) if f.endswith('.xlsx')]
    dataframes = []
    for excel_file in excel_files:
        file_path = os.path.join(folder_path, excel_file)
        df = pd.read_excel(file_path)
        dataframes.append(df)
    return dataframes

def folder_view(request):
    folders = get_folders()
    dataframes = []
    selected_folder = None
    if request.method == 'POST':
        selected_folder = request.POST.get('folder')
        if selected_folder:
            dataframes = read_excel_files(selected_folder)
    context = {
        'folders': folders,
        'dataframes': dataframes,
        'selected_folder': selected_folder,
    }
    return render(request, 'main_file.html', context)













<!DOCTYPE html>
<html>
<head>
    <title>Select Folder</title>
</head>
<body>
    <h1>Select a Folder</h1>

    <!-- Debug information -->
    <p>Number of folders: {{ folders|length }}</p>
    <p>Folders: {{ folders|join:", " }}</p>

    <form method="post">
        {% csrf_token %}
        <select name="folder">
            <option value="">Select a folder</option>
            {% for folder in folders %}
                <option value="{{ folder }}" {% if folder == selected_folder %}selected{% endif %}>{{ folder }}</option>
            {% endfor %}
        </select>
        <button type="submit">Submit</button>
    </form>

    {% if selected_folder %}
        <h2>Selected Folder: {{ selected_folder }}</h2>
    {% endif %}

    {% if dataframes %}
        <h2>Data from Excel Files</h2>
        {% for df in dataframes %}
            <h3>DataFrame {{ forloop.counter }}</h3>
            <p>Columns: {{ df.columns|join:", " }}</p>
            <p>Rows: {{ df.shape.0 }}</p>
            <table border="1">
                <thead>
                    <tr>
                        {% for col in df.columns %}
                            <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for _, row in df.iterrows %}
                        <tr>
                            {% for cell in row %}
                                <td>{{ cell }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endfor %}
    {% else %}
        <p>No data to display</p>
    {% endif %}
</body>
</html>






























































import os
import pandas as pd
from django.shortcuts import render

FOLDER_PATH = r'C:\Users\45363901\MI_Tool_Visualization\punitproject\Folder_Structure'

def get_folders():
    folders = [f.name for f in os.scandir(FOLDER_PATH) if f.is_dir()]
    print("Folders:", folders)  # Debug print
    return folders

def read_excel_files(folder_name):
    folder_path = os.path.join(FOLDER_PATH, folder_name)
    excel_files = [f for f in os.listdir(folder_path) if f.endswith('.xlsx')]
    dataframes = []
    for excel_file in excel_files:
        file_path = os.path.join(folder_path, excel_file)
        df = pd.read_excel(file_path)
        dataframes.append(df)
    return dataframes

def folder_view(request):
    folders = get_folders()
    dataframes = []
    selected_folder = None
    if request.method == 'POST':
        selected_folder = request.POST.get('folder')
        print("Selected folder:", selected_folder)  # Debug print
        if selected_folder:
            dataframes = read_excel_files(selected_folder)
            print(f"Number of dataframes: {len(dataframes)}")  # Debug print

    context = {
        'folders': folders,
        'dataframes': dataframes,
        'selected_folder': selected_folder,
    }
    return render(request, 'main_file.html', context)
















<!DOCTYPE html>
<html>
<head>
    <title>Select Folder</title>
</head>
<body>
    <h1>Select a Folder</h1>

    <!-- Debug information -->
    <p>Number of folders: {{ folders|length }}</p>
    <p>Folders: {{ folders|join:", " }}</p>

    <form method="post">
        {% csrf_token %}
        <select name="folder">
            <option value="">Select a folder</option>
            {% for folder in folders %}
                <option value="{{ folder }}" {% if folder == selected_folder %}selected{% endif %}>{{ folder }}</option>
            {% endfor %}
        </select>
        <button type="submit">Submit</button>
    </form>

    {% if selected_folder %}
        <h2>Selected Folder: {{ selected_folder }}</h2>
    {% endif %}

    {% if dataframes %}
        <h2>Data from Excel Files</h2>
        {% for df in dataframes %}
            <h3>DataFrame {{ forloop.counter }}</h3>
            <p>Columns: {{ df.columns|join:", " }}</p>
            <p>Rows: {{ df.shape.0 }}</p>
            <table border="1">
                <thead>
                    <tr>
                        {% for col in df.columns %}
                            <th>{{ col }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for _, row in df.iterrows %}
                        <tr>
                            {% for cell in row %}
                                <td>{{ cell }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endfor %}
    {% else %}
        <p>No data to display</p>
    {% endif %}
</body>
</html>









from django.contrib import admin
from django.urls import path
from Home import views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', views.folder_view, name='folder_view'),
]