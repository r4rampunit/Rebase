import sqlite3

try:
    # Connect to the SQLite database
    conn = sqlite3.connect(self_path)
    cursor = conn.cursor()
    
    # First add the column if it doesn't exist
    try:
        cursor.execute('ALTER TABLE Monthly_table ADD COLUMN 2015_flag INTEGER DEFAULT 0')
    except sqlite3.OperationalError:
        # Column might already exist, continue
        pass
    
    # Update specific dates with value 1
    cursor.execute('''
        UPDATE Monthly_table 
        SET [2015_flag] = CASE 
            WHEN date IN ('2015-02-28 00:00:00', '2015-03-31 00:00:00', '2015-04-30 00:00:00') THEN 1 
            ELSE 0 
        END
    ''')
    
    # Commit the changes
    conn.commit()
    print("2015_flag column updated successfully")
    
except sqlite3.Error as e:
    print(f"An error occurred: {e}")
    conn.rollback()
finally:
    conn.close()