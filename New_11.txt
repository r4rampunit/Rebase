import sqlite3
import pandas as pd

def read_raw_layer_tables(db_path):
    # Connect to the SQLite database
    conn = sqlite3.connect(db_path)
    
    # Read the raw_layer_info to get table names
    raw_layer_tables = pd.read_sql_query("SELECT table_name, year, quarter FROM raw_layer_info", conn)
    print("Raw Layer Tables:")
    print(raw_layer_tables)
    print("\n")
    
    # Iterate through tables and print their contents
    for _, row in raw_layer_tables.iterrows():
        table_name = row['table_name']
        
        # Read the table contents
        df = pd.read_sql_query(f'SELECT * FROM "{table_name}"', conn)
        
        print(f"Table: {table_name}")
        print(f"Year: {row['year']}, Quarter: {row['quarter']}")
        print(df)
        print("\n" + "="*50 + "\n")
    
    # Close the connection
    conn.close()

# Usage
db_path = 'FRY9C_Database.sqlite'
read_raw_layer_tables(db_path)
